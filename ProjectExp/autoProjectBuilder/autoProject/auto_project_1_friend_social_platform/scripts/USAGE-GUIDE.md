# ğŸš€ æ™ºèƒ½æœåŠ¡ç›‘æ§å’Œè‡ªåŠ¨ä¿®å¤ç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„æœåŠ¡ç›‘æ§å’Œè‡ªåŠ¨ä¿®å¤è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ä¸‰ä¸ªæ ¸å¿ƒè„šæœ¬ï¼š

1. **`quick-monitor.sh`** - å¿«é€Ÿç›‘æ§è„šæœ¬ (æ¨èæ—¥å¸¸ä½¿ç”¨)
2. **`auto-repair-monitor.sh`** - å®Œæ•´åŠŸèƒ½ç›‘æ§è„šæœ¬
3. **`start-monitoring.sh`** - ä¸€é”®å¯åŠ¨æ‰€æœ‰ç›‘æ§æœåŠ¡

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä¸€é”®å¯åŠ¨ (æ¨è)

```bash
# å¯åŠ¨æ‰€æœ‰ç›‘æ§æœåŠ¡
./scripts/start-monitoring.sh start

# æŸ¥çœ‹çŠ¶æ€
./scripts/start-monitoring.sh status

# åœæ­¢æ‰€æœ‰ç›‘æ§
./scripts/start-monitoring.sh stop
```

### æ–¹æ³•äºŒï¼šå•ç‹¬ä½¿ç”¨

```bash
# å¿«é€Ÿæ£€æŸ¥ (æ¨èæ—¥å¸¸ä½¿ç”¨)
./scripts/quick-monitor.sh check

# æŒç»­ç›‘æ§ (30ç§’é—´éš”)
./scripts/quick-monitor.sh monitor 30

# å®Œæ•´åŠŸèƒ½ç›‘æ§ (5åˆ†é’Ÿé—´éš”)
./scripts/auto-repair-monitor.sh monitor --interval 300
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### âœ¨ æ™ºèƒ½æ£€æµ‹
- **ç«¯å£æ£€æŸ¥**: è‡ªåŠ¨æ£€æµ‹æœåŠ¡ç«¯å£å ç”¨æƒ…å†µ
- **å¥åº·æ£€æŸ¥**: éªŒè¯æœåŠ¡å¥åº·çŠ¶æ€ (æ”¯æŒ /health æ¥å£)
- **çŠ¶æ€åˆ†ç±»**: è¿è¡Œä¸­/å·²åœæ­¢/ä¸å¥åº·
- **å®æ—¶æ›´æ–°**: åŠ¨æ€çŠ¶æ€ç›‘æ§

### ğŸ› ï¸ è‡ªåŠ¨ä¿®å¤
- **å¹¶è¡Œä¿®å¤**: åŒæ—¶ä¿®å¤å¤šä¸ªæœåŠ¡ï¼Œæé«˜æ•ˆç‡
- **æ™ºèƒ½é‡è¯•**: å¯é…ç½®æœ€å¤§é‡è¯•æ¬¡æ•°
- **å¤±è´¥è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«æ— æ³•ä¿®å¤çš„æœåŠ¡
- **ä¿®å¤å†å²**: è®°å½•æ‰€æœ‰ä¿®å¤æ“ä½œ

### ğŸ“Š è¯¦ç»†æŠ¥å‘Š
- **JSONæŠ¥å‘Š**: ç»“æ„åŒ–çš„ä¿®å¤æŠ¥å‘Š
- **å¥åº·ç»Ÿè®¡**: æœåŠ¡å¥åº·åº¦ç»Ÿè®¡
- **ä¿®å¤å»ºè®®**: é’ˆå¯¹å¤±è´¥æœåŠ¡çš„å»ºè®®
- **å†å²è¿½è¸ª**: å®Œæ•´çš„ä¿®å¤å†å²è®°å½•

### ğŸ”„ æŒç»­ç›‘æ§
- **å¯é…ç½®é—´éš”**: æ”¯æŒè‡ªå®šä¹‰æ£€æŸ¥é—´éš”
- **åå°è¿è¡Œ**: æ”¯æŒåå°æŒç»­ç›‘æ§
- **ä¼˜é›…åœæ­¢**: æ”¯æŒ Ctrl+C ä¼˜é›…åœæ­¢
- **ç³»ç»Ÿé€šçŸ¥**: é›†æˆç³»ç»Ÿé€šçŸ¥åŠŸèƒ½

## ğŸ“ˆ ä½¿ç”¨åœºæ™¯

### ğŸ  å¼€å‘ç¯å¢ƒ
```bash
# å¿«é€Ÿæ£€æŸ¥å¼€å‘ç¯å¢ƒ
./scripts/quick-monitor.sh check

# æŒç»­ç›‘æ§ (30ç§’é—´éš”)
./scripts/quick-monitor.sh monitor 30

# æŸ¥çœ‹çŠ¶æ€
./scripts/start-monitoring.sh status
```

### ğŸ­ ç”Ÿäº§ç¯å¢ƒ
```bash
# å¯åŠ¨å®Œæ•´ç›‘æ§ (5åˆ†é’Ÿé—´éš”)
./scripts/auto-repair-monitor.sh monitor --interval 300

# åå°è¿è¡Œ
nohup ./scripts/auto-repair-monitor.sh monitor > monitor.log 2>&1 &

# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
./scripts/auto-repair-monitor.sh report
```

### ğŸ” æ•…éšœæ’æŸ¥
```bash
# å¿«é€Ÿè¯Šæ–­
./scripts/quick-monitor.sh check

# è¯¦ç»†åˆ†æ
./scripts/auto-repair-monitor.sh check

# æŸ¥çœ‹ä¿®å¤æŠ¥å‘Š
cat reports/repair-report-*.json | jq '.summary'

# æŸ¥çœ‹æ—¥å¿—
./scripts/start-monitoring.sh logs quick-monitor
```

## ğŸ›ï¸ é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# æ£€æŸ¥é—´éš” (ç§’)
export CHECK_INTERVAL=300

# æœ€å¤§ä¿®å¤å°è¯•æ¬¡æ•°
export MAX_REPAIR_ATTEMPTS=3

# æ˜¯å¦å¯ç”¨é€šçŸ¥
export ENABLE_NOTIFICATIONS=true

# ä¿ç•™çš„æœ€å¤§æŠ¥å‘Šæ•°
export MAX_REPORTS=10
```

### å‘½ä»¤è¡Œé€‰é¡¹
```bash
# è®¾ç½®æ£€æŸ¥é—´éš”
--interval SECONDS

# è®¾ç½®æœ€å¤§ä¿®å¤å°è¯•æ¬¡æ•°
--max-attempts NUM

# ç¦ç”¨é€šçŸ¥
--no-notifications

# è®¾ç½®ä¿ç•™çš„æœ€å¤§æŠ¥å‘Šæ•°
--max-reports NUM
```

## ğŸ“Š ç›‘æ§çš„æœåŠ¡

| æœåŠ¡ | ç«¯å£ | æ£€æŸ¥æ–¹å¼ | ä¿®å¤æ–¹å¼ | çŠ¶æ€ |
|------|------|----------|----------|------|
| åç«¯æœåŠ¡ | 8000 | ç«¯å£ + å¥åº·æ£€æŸ¥ | é‡å¯æœåŠ¡ | âœ… |
| AIæœåŠ¡ | 8001 | ç«¯å£ + å¥åº·æ£€æŸ¥ | é‡å¯æœåŠ¡ | âœ… |
| Redis | 6379 | ç«¯å£æ£€æŸ¥ | å¯åŠ¨æœåŠ¡ | âœ… |
| å‰ç«¯æœåŠ¡ | 3000 | ç«¯å£æ£€æŸ¥ | å‰ç«¯ç®¡ç†å™¨ | âš ï¸ |

## ğŸš€ ä¸€é”®å¯åŠ¨è„šæœ¬

### å®Œæ•´åŠŸèƒ½
```bash
# å¯åŠ¨æ‰€æœ‰ç›‘æ§æœåŠ¡
./scripts/start-monitoring.sh start

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./scripts/start-monitoring.sh status

# æŸ¥çœ‹æ—¥å¿—
./scripts/start-monitoring.sh logs quick-monitor

# å¿«é€Ÿæ£€æŸ¥
./scripts/start-monitoring.sh check

# åœæ­¢æ‰€æœ‰æœåŠ¡
./scripts/start-monitoring.sh stop

# é‡å¯æ‰€æœ‰æœåŠ¡
./scripts/start-monitoring.sh restart
```

### å¯åŠ¨çš„æœåŠ¡
1. **æœåŠ¡ç®¡ç†å™¨**: è‡ªåŠ¨å¯åŠ¨åŸºç¡€æœåŠ¡
2. **å¿«é€Ÿç›‘æ§**: 30ç§’é—´éš”çš„å¿«é€Ÿæ£€æŸ¥
3. **å®Œæ•´ç›‘æ§**: 5åˆ†é’Ÿé—´éš”çš„è¯¦ç»†ç›‘æ§

## ğŸ“ è¾“å‡ºç¤ºä¾‹

### å¿«é€Ÿç›‘æ§è¾“å‡º
```
[14:30:15] ğŸ” å¿«é€Ÿæ£€æŸ¥æœåŠ¡çŠ¶æ€...
âœ… backend: è¿è¡Œä¸­
âš ï¸  ai: å·²åœæ­¢
âœ… redis: è¿è¡Œä¸­
âœ… frontend: è¿è¡Œä¸­

[14:30:15] ğŸ“Š çŠ¶æ€æ‘˜è¦: 3/4 ä¸ªæœåŠ¡æ­£å¸¸è¿è¡Œ

[14:30:15] ğŸ”§ å¼€å§‹è‡ªåŠ¨ä¿®å¤...
[14:30:15] ä¿®å¤ ai...
âœ… ai ä¿®å¤æˆåŠŸ

[14:30:16] æˆåŠŸä¿®å¤ 1 ä¸ªæœåŠ¡
```

### å®Œæ•´ç›‘æ§è¾“å‡º
```
[2024-01-15 14:30:15] [INFO] ğŸ” æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€...
[2024-01-15 14:30:15] [SUCCESS] âœ… backend: healthy
[2024-01-15 14:30:15] [WARNING] âš ï¸  ai: stopped
[2024-01-15 14:30:15] [SUCCESS] âœ… redis: running
[2024-01-15 14:30:15] [INFO] æœåŠ¡å¥åº·åº¦: 2/4

[2024-01-15 14:30:15] [INFO] ğŸ”§ å¼€å§‹æ‰¹é‡ä¿®å¤ 2 ä¸ªæœåŠ¡...
[2024-01-15 14:30:16] [SUCCESS] æœåŠ¡ ai ä¿®å¤æˆåŠŸ
[2024-01-15 14:30:16] [SUCCESS] æˆåŠŸä¿®å¤ 1 ä¸ªæœåŠ¡

==================================
ğŸ“‹ ä¿®å¤æŠ¥å‘Šæ‘˜è¦
==================================
æ£€æŸ¥æ—¶é—´: 2024-01-15 14:30:15
æ€»æœåŠ¡æ•°: 4
å¥åº·æœåŠ¡: 3
ä¿®å¤æœåŠ¡: 1
å¤±è´¥æœåŠ¡: 0
==================================
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æƒé™é—®é¢˜**
   ```bash
   chmod +x scripts/*.sh
   ```

2. **ä¾èµ–ç¼ºå¤±**
   ```bash
   # å®‰è£… jq (ç”¨äºJSONå¤„ç†)
   brew install jq  # macOS
   apt-get install jq  # Ubuntu
   ```

3. **ç«¯å£å†²çª**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   lsof -i :8000
   
   # åœæ­¢å†²çªè¿›ç¨‹
   kill -9 $(lsof -ti :8000)
   ```

4. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   tail -f logs/backend.log
   tail -f logs/ai-service.log
   ```

### è°ƒè¯•æ¨¡å¼
```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
DEBUG=true ./scripts/auto-repair-monitor.sh check

# æŸ¥çœ‹ç›‘æ§æ—¥å¿—
tail -f logs/auto-repair-monitor.log
```

## ğŸ¯ æœ€ä½³å®è·µ

### å¼€å‘ç¯å¢ƒ
- ä½¿ç”¨ `quick-monitor.sh` è¿›è¡Œå¿«é€Ÿæ£€æŸ¥
- è®¾ç½®30-60ç§’çš„æ£€æŸ¥é—´éš”
- å…³æ³¨å®æ—¶çŠ¶æ€å˜åŒ–

### ç”Ÿäº§ç¯å¢ƒ
- ä½¿ç”¨ `auto-repair-monitor.sh` è¿›è¡Œå®Œæ•´ç›‘æ§
- è®¾ç½®5-15åˆ†é’Ÿçš„æ£€æŸ¥é—´éš”
- å¯ç”¨è¯¦ç»†æŠ¥å‘Šå’Œé€šçŸ¥

### ç›‘æ§ç­–ç•¥
- **é«˜é¢‘æ£€æŸ¥**: å¼€å‘ç¯å¢ƒï¼Œå¿«é€Ÿå‘ç°é—®é¢˜
- **ä½é¢‘æ£€æŸ¥**: ç”Ÿäº§ç¯å¢ƒï¼Œå‡å°‘èµ„æºæ¶ˆè€—
- **æ™ºèƒ½ä¿®å¤**: è‡ªåŠ¨ä¿®å¤å¸¸è§é—®é¢˜
- **äººå·¥å¹²é¢„**: å¤æ‚é—®é¢˜éœ€è¦æ‰‹åŠ¨å¤„ç†

## ğŸ”„ é›†æˆå»ºè®®

### ç³»ç»ŸæœåŠ¡é›†æˆ
```bash
# åˆ›å»ºç³»ç»ŸæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/auto-repair-monitor.service

# å¯åŠ¨æœåŠ¡
sudo systemctl enable auto-repair-monitor
sudo systemctl start auto-repair-monitor
```

### Cron ä»»åŠ¡é›†æˆ
```bash
# ç¼–è¾‘ crontab
crontab -e

# æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
*/5 * * * * /path/to/project/scripts/quick-monitor.sh check
```

### CI/CD é›†æˆ
```yaml
# GitHub Actions ç¤ºä¾‹
- name: Service Health Check
  run: |
    ./scripts/auto-repair-monitor.sh check
    if [ $? -ne 0 ]; then
      echo "Service health check failed"
      exit 1
    fi
```

## ğŸ“š æ‰©å±•åŠŸèƒ½

### è‡ªå®šä¹‰æœåŠ¡ç›‘æ§
1. åœ¨ç«¯å£é…ç½®ä¸­æ·»åŠ æ–°ç«¯å£
2. åœ¨ `get_service_status()` å‡½æ•°ä¸­æ·»åŠ æœåŠ¡æ£€æŸ¥é€»è¾‘
3. åœ¨ `auto_repair_service()` å‡½æ•°ä¸­æ·»åŠ ä¿®å¤é€»è¾‘

### è‡ªå®šä¹‰ä¿®å¤ç­–ç•¥
- **æ•°æ®åº“æœåŠ¡**: æ£€æŸ¥è¿æ¥æ± çŠ¶æ€
- **ç¼“å­˜æœåŠ¡**: æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
- **å‰ç«¯æœåŠ¡**: æ£€æŸ¥æ„å»ºçŠ¶æ€

## ğŸ†˜ æ”¯æŒ

### æ—¥å¿—æ–‡ä»¶
- ç›‘æ§æ—¥å¿—: `logs/auto-repair-monitor.log`
- å¿«é€Ÿç›‘æ§: `logs/quick-monitor.log`
- æœåŠ¡ç®¡ç†å™¨: `logs/service-manager.log`

### ä¿®å¤æŠ¥å‘Š
- ä½ç½®: `reports/repair-report-*.json`
- æ ¼å¼: JSONæ ¼å¼ï¼ŒåŒ…å«è¯¦ç»†ç»Ÿè®¡
- ä¿ç•™: è‡ªåŠ¨æ¸…ç†æ—§æŠ¥å‘Š

### è¯Šæ–­å‘½ä»¤
```bash
# æœåŠ¡è¯Šæ–­
./scripts/service-manager.sh diagnose [service]

# çŠ¶æ€æ£€æŸ¥
./scripts/start-monitoring.sh status

# æ—¥å¿—æŸ¥çœ‹
./scripts/start-monitoring.sh logs [service]
```

## ğŸ‰ æ€»ç»“

è¿™ä¸ªæ™ºèƒ½ç›‘æ§ç³»ç»Ÿæä¾›äº†ï¼š

1. **å¿«é€Ÿå“åº”**: 30ç§’å†…æ£€æµ‹å’Œä¿®å¤é—®é¢˜
2. **æ™ºèƒ½ä¿®å¤**: è‡ªåŠ¨å¤„ç†å¸¸è§æ•…éšœ
3. **è¯¦ç»†æŠ¥å‘Š**: å®Œæ•´çš„ä¿®å¤å†å²å’Œç»Ÿè®¡
4. **æ˜“äºä½¿ç”¨**: ä¸€é”®å¯åŠ¨ï¼Œç®€å•é…ç½®
5. **é«˜åº¦å¯å®šåˆ¶**: æ”¯æŒè‡ªå®šä¹‰æœåŠ¡å’Œä¿®å¤ç­–ç•¥

**æ¨èä½¿ç”¨æµç¨‹**:
1. å¼€å‘ç¯å¢ƒ: `./scripts/quick-monitor.sh monitor 30`
2. ç”Ÿäº§ç¯å¢ƒ: `./scripts/start-monitoring.sh start`
3. æ•…éšœæ’æŸ¥: `./scripts/auto-repair-monitor.sh check`
4. å®šæœŸç»´æŠ¤: `./scripts/auto-repair-monitor.sh cleanup` 