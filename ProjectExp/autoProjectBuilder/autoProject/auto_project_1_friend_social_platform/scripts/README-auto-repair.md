# æ™ºèƒ½æœåŠ¡ç›‘æ§å’Œè‡ªåŠ¨ä¿®å¤ç³»ç»Ÿ

## æ¦‚è¿°

æœ¬é¡¹ç›®æä¾›äº†ä¸¤ä¸ªæ™ºèƒ½ç›‘æ§è„šæœ¬ï¼Œç”¨äºè‡ªåŠ¨æ£€æµ‹å’Œä¿®å¤æœåŠ¡é—®é¢˜ï¼š

1. **`auto-repair-monitor.sh`** - å®Œæ•´åŠŸèƒ½ç‰ˆæœ¬ï¼ŒåŒ…å«è¯¦ç»†æŠ¥å‘Šå’Œé«˜çº§åŠŸèƒ½
2. **`quick-monitor.sh`** - ç®€åŒ–ç‰ˆæœ¬ï¼Œä¸“æ³¨äºå¿«é€Ÿæ£€æŸ¥å’Œä¿®å¤

## å¿«é€Ÿå¼€å§‹

### 1. å¿«é€Ÿç›‘æ§è„šæœ¬ (æ¨èæ—¥å¸¸ä½¿ç”¨)

```bash
# å•æ¬¡æ£€æŸ¥
./scripts/quick-monitor.sh check

# æŒç»­ç›‘æ§ (60ç§’é—´éš”)
./scripts/quick-monitor.sh monitor

# æŒç»­ç›‘æ§ (30ç§’é—´éš”)
./scripts/quick-monitor.sh monitor 30
```

### 2. å®Œæ•´åŠŸèƒ½ç›‘æ§è„šæœ¬

```bash
# å•æ¬¡æ£€æŸ¥å’Œä¿®å¤
./scripts/auto-repair-monitor.sh check

# æŒç»­ç›‘æ§ (5åˆ†é’Ÿé—´éš”)
./scripts/auto-repair-monitor.sh monitor

# è‡ªå®šä¹‰é—´éš”ç›‘æ§ (2åˆ†é’Ÿ)
./scripts/auto-repair-monitor.sh monitor --interval 120

# ç”ŸæˆçŠ¶æ€æŠ¥å‘Š
./scripts/auto-repair-monitor.sh report

# æ¸…ç†æ—§æŠ¥å‘Š
./scripts/auto-repair-monitor.sh cleanup
```

## åŠŸèƒ½ç‰¹æ€§

### âœ¨ æ™ºèƒ½æ£€æµ‹
- è‡ªåŠ¨æ£€æµ‹æœåŠ¡è¿è¡ŒçŠ¶æ€
- ç«¯å£å ç”¨æ£€æŸ¥
- å¥åº·çŠ¶æ€éªŒè¯
- å®æ—¶çŠ¶æ€æ›´æ–°

### ğŸ”§ è‡ªåŠ¨ä¿®å¤
- å¹¶è¡Œä¿®å¤å¤šä¸ªæœåŠ¡
- æ™ºèƒ½é‡è¯•æœºåˆ¶
- å¤±è´¥æœåŠ¡è¯†åˆ«
- ä¿®å¤å†å²è®°å½•

### ğŸ“Š è¯¦ç»†æŠ¥å‘Š
- JSONæ ¼å¼ä¿®å¤æŠ¥å‘Š
- æœåŠ¡å¥åº·åº¦ç»Ÿè®¡
- ä¿®å¤å»ºè®®ç”Ÿæˆ
- å†å²è®°å½•è¿½è¸ª

### ğŸ”„ æŒç»­ç›‘æ§
- å¯é…ç½®æ£€æŸ¥é—´éš”
- åå°è¿è¡Œæ”¯æŒ
- ä¼˜é›…åœæ­¢å¤„ç†
- ç³»ç»Ÿé€šçŸ¥é›†æˆ

### âš¡ æ€§èƒ½ä¼˜åŒ–
- å¹¶è¡Œå¤„ç†
- éé˜»å¡æ“ä½œ
- èµ„æºä½¿ç”¨ä¼˜åŒ–
- å¿«é€Ÿå“åº”

## ç›‘æ§çš„æœåŠ¡

| æœåŠ¡ | ç«¯å£ | æ£€æŸ¥æ–¹å¼ | ä¿®å¤æ–¹å¼ |
|------|------|----------|----------|
| åç«¯æœåŠ¡ | 8000 | ç«¯å£ + å¥åº·æ£€æŸ¥ | é‡å¯æœåŠ¡ |
| AIæœåŠ¡ | 8001 | ç«¯å£ + å¥åº·æ£€æŸ¥ | é‡å¯æœåŠ¡ |
| Redis | 6379 | ç«¯å£æ£€æŸ¥ | å¯åŠ¨æœåŠ¡ |
| å‰ç«¯æœåŠ¡ | 3000 | ç«¯å£æ£€æŸ¥ | å‰ç«¯ç®¡ç†å™¨ |

## é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡

```bash
# æ£€æŸ¥é—´éš” (ç§’)
export CHECK_INTERVAL=300

# æœ€å¤§ä¿®å¤å°è¯•æ¬¡æ•°
export MAX_REPAIR_ATTEMPTS=3

# æ˜¯å¦å¯ç”¨é€šçŸ¥
export ENABLE_NOTIFICATIONS=true

# ä¿ç•™çš„æœ€å¤§æŠ¥å‘Šæ•°
export MAX_REPORTS=10
```

### å‘½ä»¤è¡Œé€‰é¡¹

```bash
# è®¾ç½®æ£€æŸ¥é—´éš”
--interval SECONDS

# è®¾ç½®æœ€å¤§ä¿®å¤å°è¯•æ¬¡æ•°
--max-attempts NUM

# ç¦ç”¨é€šçŸ¥
--no-notifications

# è®¾ç½®ä¿ç•™çš„æœ€å¤§æŠ¥å‘Šæ•°
--max-reports NUM
```

## ä½¿ç”¨åœºæ™¯

### 1. å¼€å‘ç¯å¢ƒç›‘æ§
```bash
# å¿«é€Ÿæ£€æŸ¥å¼€å‘ç¯å¢ƒ
./scripts/quick-monitor.sh check

# æŒç»­ç›‘æ§ (30ç§’é—´éš”)
./scripts/quick-monitor.sh monitor 30
```

### 2. ç”Ÿäº§ç¯å¢ƒç›‘æ§
```bash
# å®Œæ•´ç›‘æ§ (5åˆ†é’Ÿé—´éš”)
./scripts/auto-repair-monitor.sh monitor --interval 300

# åå°è¿è¡Œ
nohup ./scripts/auto-repair-monitor.sh monitor > monitor.log 2>&1 &
```

### 3. æ•…éšœæ’æŸ¥
```bash
# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
./scripts/auto-repair-monitor.sh report

# æŸ¥çœ‹ä¿®å¤å†å²
cat reports/repair-report-*.json | jq '.summary'
```

### 4. å®šæœŸç»´æŠ¤
```bash
# æ¸…ç†æ—§æŠ¥å‘Š
./scripts/auto-repair-monitor.sh cleanup

# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
./scripts/auto-repair-monitor.sh check
```

## è¾“å‡ºç¤ºä¾‹

### å¿«é€Ÿç›‘æ§è¾“å‡º
```
[14:30:15] ğŸ” å¿«é€Ÿæ£€æŸ¥æœåŠ¡çŠ¶æ€...
âœ… backend: è¿è¡Œä¸­
âš ï¸  ai: å·²åœæ­¢
âœ… redis: è¿è¡Œä¸­
âœ… frontend: è¿è¡Œä¸­

[14:30:15] ğŸ“Š çŠ¶æ€æ‘˜è¦: 3/4 ä¸ªæœåŠ¡æ­£å¸¸è¿è¡Œ

[14:30:15] ğŸ”§ å¼€å§‹è‡ªåŠ¨ä¿®å¤...
[14:30:15] ä¿®å¤ ai...
âœ… ai ä¿®å¤æˆåŠŸ

[14:30:16] æˆåŠŸä¿®å¤ 1 ä¸ªæœåŠ¡
```

### å®Œæ•´ç›‘æ§è¾“å‡º
```
[2024-01-15 14:30:15] [INFO] ğŸ” æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€...
[2024-01-15 14:30:15] [SUCCESS] âœ… backend: healthy
[2024-01-15 14:30:15] [WARNING] âš ï¸  ai: stopped
[2024-01-15 14:30:15] [SUCCESS] âœ… redis: running
[2024-01-15 14:30:15] [INFO] æœåŠ¡å¥åº·åº¦: 2/4

[2024-01-15 14:30:15] [INFO] ğŸ”§ å¼€å§‹æ‰¹é‡ä¿®å¤ 2 ä¸ªæœåŠ¡...
[2024-01-15 14:30:16] [SUCCESS] æœåŠ¡ ai ä¿®å¤æˆåŠŸ
[2024-01-15 14:30:16] [SUCCESS] æˆåŠŸä¿®å¤ 1 ä¸ªæœåŠ¡

==================================
ğŸ“‹ ä¿®å¤æŠ¥å‘Šæ‘˜è¦
==================================
æ£€æŸ¥æ—¶é—´: 2024-01-15 14:30:15
æ€»æœåŠ¡æ•°: 4
å¥åº·æœåŠ¡: 3
ä¿®å¤æœåŠ¡: 1
å¤±è´¥æœåŠ¡: 0
==================================
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æƒé™é—®é¢˜**
   ```bash
   chmod +x scripts/*.sh
   ```

2. **ä¾èµ–ç¼ºå¤±**
   ```bash
   # å®‰è£… jq (ç”¨äºJSONå¤„ç†)
   brew install jq  # macOS
   apt-get install jq  # Ubuntu
   ```

3. **ç«¯å£å†²çª**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   lsof -i :8000
   
   # åœæ­¢å†²çªè¿›ç¨‹
   kill -9 $(lsof -ti :8000)
   ```

4. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   tail -f logs/backend.log
   tail -f logs/ai-service.log
   ```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
DEBUG=true ./scripts/auto-repair-monitor.sh check

# æŸ¥çœ‹ç›‘æ§æ—¥å¿—
tail -f logs/auto-repair-monitor.log
```

## é›†æˆå»ºè®®

### 1. ç³»ç»ŸæœåŠ¡é›†æˆ
```bash
# åˆ›å»ºç³»ç»ŸæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/auto-repair-monitor.service

# å¯åŠ¨æœåŠ¡
sudo systemctl enable auto-repair-monitor
sudo systemctl start auto-repair-monitor
```

### 2. Cron ä»»åŠ¡é›†æˆ
```bash
# ç¼–è¾‘ crontab
crontab -e

# æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
*/5 * * * * /path/to/project/scripts/quick-monitor.sh check
```

### 3. CI/CD é›†æˆ
```yaml
# GitHub Actions ç¤ºä¾‹
- name: Service Health Check
  run: |
    ./scripts/auto-repair-monitor.sh check
    if [ $? -ne 0 ]; then
      echo "Service health check failed"
      exit 1
    fi
```

## æœ€ä½³å®è·µ

1. **å¼€å‘ç¯å¢ƒ**: ä½¿ç”¨ `quick-monitor.sh` è¿›è¡Œå¿«é€Ÿæ£€æŸ¥
2. **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨ `auto-repair-monitor.sh` è¿›è¡Œå®Œæ•´ç›‘æ§
3. **ç›‘æ§é—´éš”**: å¼€å‘ç¯å¢ƒ30-60ç§’ï¼Œç”Ÿäº§ç¯å¢ƒ5-15åˆ†é’Ÿ
4. **æ—¥å¿—ç®¡ç†**: å®šæœŸæ¸…ç†æ—§æ—¥å¿—å’ŒæŠ¥å‘Šæ–‡ä»¶
5. **é€šçŸ¥é…ç½®**: æ ¹æ®ç¯å¢ƒé…ç½®é€‚å½“çš„é€šçŸ¥æ–¹å¼

## æ‰©å±•åŠŸèƒ½

### è‡ªå®šä¹‰æœåŠ¡ç›‘æ§
åœ¨è„šæœ¬ä¸­æ·»åŠ æ–°çš„æœåŠ¡ç›‘æ§ï¼š

1. åœ¨ç«¯å£é…ç½®ä¸­æ·»åŠ æ–°ç«¯å£
2. åœ¨ `get_service_status()` å‡½æ•°ä¸­æ·»åŠ æœåŠ¡æ£€æŸ¥é€»è¾‘
3. åœ¨ `auto_repair_service()` å‡½æ•°ä¸­æ·»åŠ ä¿®å¤é€»è¾‘

### è‡ªå®šä¹‰ä¿®å¤ç­–ç•¥
æ ¹æ®æœåŠ¡ç‰¹ç‚¹å®šåˆ¶ä¿®å¤ç­–ç•¥ï¼š

1. æ•°æ®åº“æœåŠ¡: æ£€æŸ¥è¿æ¥æ± çŠ¶æ€
2. ç¼“å­˜æœåŠ¡: æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
3. å‰ç«¯æœåŠ¡: æ£€æŸ¥æ„å»ºçŠ¶æ€

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶: `logs/auto-repair-monitor.log`
2. æ£€æŸ¥ä¿®å¤æŠ¥å‘Š: `reports/repair-report-*.json`
3. è¿è¡Œè¯Šæ–­å‘½ä»¤: `./scripts/service-manager.sh diagnose [service]` 