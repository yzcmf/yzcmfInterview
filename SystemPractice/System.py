# self not done project -- design ability for an interview
'''
ç³»ç»Ÿè®¾è®¡å…³é”®åœ¨äº æŠ€æœ¯ç§¯ç´¯ï¼Œå‡†ç¡®ä¸”å¿«é€Ÿäº¤ä»˜

ç³»ç»Ÿè®¾è®¡ï¼šå¦‚ä½•å±•ç¤º trade-off å’Œå…¨ç”Ÿå‘½å‘¨æœŸ

1. ä»€ä¹ˆæ˜¯ trade-offï¼Ÿï¼ˆæƒè¡¡ï¼‰
* æ¯ä¸ªè®¾è®¡å†³ç­–éƒ½è¦æœ‰ä¼˜åŠ£å¯¹æ¯”ï¼šå¦‚é€‰å“ªç§æ•°æ®åº“ã€åˆ†å¸ƒå¼/å•ä½“ã€åŒæ­¥/å¼‚æ­¥ã€ç¼“å­˜ç­–ç•¥ç­‰ã€‚
* é«˜çº§åˆ«é¢è¯•å®˜å…³æ³¨ä½ æ˜¯å¦èƒ½ï¼š
    * è¯†åˆ«å¹¶æƒè¡¡å¤šç§æ–¹æ¡ˆï¼ˆæœ‰å¤§å±€è§‚/æ¶æ„è§†é‡ï¼‰
    * æ˜ç¡®trade-offç†ç”±ï¼ˆå¦‚æˆæœ¬/æ€§èƒ½/å¤æ‚åº¦/å¯ç»´æŠ¤æ€§/ä¸Šçº¿é€Ÿåº¦/å›¢é˜Ÿèƒ½åŠ›ç­‰ï¼‰
    * èƒ½é’ˆå¯¹éœ€æ±‚å˜åŒ–è°ƒæ•´è®¾è®¡

è®¾è®¡ç»´åº¦	å¸¸è§ trade-off å¯¹æ¯”	è‹±æ–‡ä¸¾ä¾‹	ä¸­æ–‡è¯´æ˜
ä¸€è‡´æ€§ vs å¯ç”¨æ€§	å¼ºä¸€è‡´æ€§ï¼ˆCPï¼‰ vs æœ€ç»ˆä¸€è‡´æ€§ï¼ˆAPï¼‰	SQL (CP) vs NoSQL (AP)	äº¤æ˜“/é‡‘èç”¨å¼ºä¸€è‡´æ€§ï¼Œç¤¾äº¤/æ—¥å¿—ç­‰ç”¨æœ€ç»ˆä¸€è‡´æ€§
æ€§èƒ½ vs æˆæœ¬	é«˜æ€§èƒ½/é«˜å¹¶å‘ï¼ˆé«˜æˆæœ¬ï¼‰ vs ä½æˆæœ¬/ä½èµ„æºæ¶ˆè€—	SSD (expensive, fast) vs HDD (cheap)	é«˜é¢‘è¯·æ±‚å¯èµ°ç¼“å­˜æˆ–SSDï¼Œå†·æ•°æ®å½’æ¡£çœæˆæœ¬
å¯æ‰©å±•æ€§ vs ç®€å•æ€§	æ°´å¹³æ‰©å±•ï¼ˆå¤æ‚/æ˜“æ‰©å®¹ï¼‰vs å•ä½“ç®€å•ï¼ˆæ˜“ç»´æŠ¤ï¼‰	Sharded DB vs Single DB	å¾®æœåŠ¡çµæ´»ï¼Œå•ä½“æ˜“ç»´æŠ¤ä½†æ‰©å±•ç“¶é¢ˆ
å¼€å‘é€Ÿåº¦ vs çµæ´»æ€§	å¿«é€Ÿä¸Šçº¿ MVP vs åæœŸçµæ´»æ¼”è¿›	Rapid MVP vs Scalable Design	å…ˆä¸Šçº¿ï¼Œåé‡æ„/é‡å¹³å°åŒ–
å»¶è¿Ÿ vs ååé‡	ä½å»¶è¿Ÿï¼ˆå¿«é€Ÿå“åº”ï¼‰vs é«˜ååï¼ˆæ‰¹å¤„ç†ã€å¤§æµé‡ï¼‰	Real-time (low-latency) vs Batch jobs	æ”¯ä»˜/IM è¦ä½å»¶è¿Ÿï¼ŒæŠ¥è¡¨ç­‰å¯æ‰¹é‡é«˜åå
å®‰å…¨æ€§ vs æ˜“ç”¨æ€§	ä¸¥æ ¼å®‰å…¨ï¼ˆåŠ å¯†/æƒé™ï¼‰vs ç®€åŒ–ç”¨æˆ·ä½“éªŒ	SSO (user-friendly) vs 2FA (secure)	é‡‘èä¸šåŠ¡å¤šé‡æ ¡éªŒï¼Œæ™®é€šæ³¨å†Œåˆ™ä¼˜å…ˆæ˜“ç”¨
ç¨³å®šæ€§ vs åˆ›æ–°æ€§	ä¿å®ˆä¸Šçº¿ã€å…¼å®¹è€ç³»ç»Ÿ vs è¿½æ±‚æ–°æŠ€æœ¯	Legacy support vs Use new stack	è€ä¸šåŠ¡å¤šä¿å®ˆï¼Œåˆ›æ–°ä¸šåŠ¡å¯å°è¯•æ–°æ¡†æ¶
åŒæ­¥ vs å¼‚æ­¥	åŒæ­¥å¤„ç†ï¼ˆå®æ—¶åé¦ˆï¼‰vs å¼‚æ­¥å¤„ç†ï¼ˆé«˜å¹¶å‘/æ˜“è§£è€¦ï¼‰	REST (sync) vs Message Queue (async)	å……å€¼/ä¸‹å•ç­‰åŒæ­¥ï¼Œé€šçŸ¥/æ—¥å¿—ç­‰å¯å¼‚æ­¥
ç¼“å­˜ vs æ•°æ®å®æ—¶æ€§	ç¼“å­˜ï¼ˆå¿«ä½†å¯èƒ½ä¸æœ€æ–°ï¼‰vs å®æ—¶æŸ¥æ•°æ®åº“ï¼ˆæ…¢ä½†å‡†ç¡®ï¼‰	Redis/Cache vs Direct DB Read	é¦–é¡µçƒ­ç‚¹å¯ç¼“å­˜ï¼Œé‡‘èæ•°æ®ç›´æ¥æŸ¥åº“
å¤šæ´» vs ä¸»å¤‡	å¤šæ´»å®¹ç¾ï¼ˆå¤æ‚/é«˜å¯ç”¨ï¼‰vs ä¸»å¤‡åˆ‡æ¢ï¼ˆç®€å•/æœ‰åˆ‡æ¢é£é™©ï¼‰	Multi-master vs Master-slave	å…¨çƒå¤§ç›˜å¤šæ´»ï¼Œæ™®é€šä¸šåŠ¡ä¸»å¤‡/å¤‡ä»½å³å¯

2. ä»€ä¹ˆæ˜¯â€œè®²å…¨ç”Ÿå‘½å‘¨æœŸâ€ï¼Ÿ
* ä¸ä»…ä»…è°ˆâ€œä¸Šçº¿â€ï¼Œè¿˜è¦è¦†ç›–ä»éœ€æ±‚æ¾„æ¸…ï¼Œè®¾è®¡å’ŒæŠ€æœ¯é€‰å‹ã€å¼€å‘æµ‹è¯•ã€ä¸Šçº¿ã€ç›‘æ§ã€æ‰©å±•ã€ç»´æŠ¤ã€è¿­ä»£å…¨è¿‡ç¨‹ã€‚
* å±•ç°ä½ èƒ½å¸¦é˜ŸæŠŠé¡¹ç›®åšå®Œå¹¶æ´»ä¸‹æ¥ã€æ‰©å±•ä¸‹å»ï¼Œè€Œä¸æ˜¯â€œåªä¼šå†™ä»£ç â€ã€‚
* å¸¸è§ç”Ÿå‘½å‘¨æœŸé˜¶æ®µï¼š
    1. éœ€æ±‚æ¾„æ¸…ä¸çº¦æŸåˆ†æ
    2. æŠ€æœ¯é€‰å‹ä¸æ¶æ„è®¾è®¡
    3. å¼€å‘ä¸æµ‹è¯•ç­–ç•¥
    4. ä¸Šçº¿ä¸å‘å¸ƒæµç¨‹
    5. ç›‘æ§ä¸æŠ¥è­¦
    6. æ‰©å±• - æ‰©å®¹/å¼¹æ€§/å®¹ç¾/æ•…éšœæ¢å¤
    7. ç»´æŠ¤ - æ€§èƒ½ä¼˜åŒ–ä¸æˆæœ¬æ§åˆ¶
    8. åæœŸè¿­ä»£ - é‡æ„å’Œè¿ç§»

ä¸­æ–‡æ ‡å‡†ç­”é¢˜æ¡†æ¶

ä¾‹é¢˜ï¼šè®¾è®¡ä¸€ä¸ªå…¨çƒå¯ç”¨çš„åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ï¼ˆå¦‚Dropbox/é˜¿é‡Œäº‘ç›˜ï¼‰
1. éœ€æ±‚æ¾„æ¸…ï¼šæé«˜å¯ç”¨æ€§ï¼Œå…¨çƒç”¨æˆ·ä½å»¶è¿Ÿè®¿é—®ï¼Œæ–‡ä»¶ä¸Šä¼ /ä¸‹è½½éœ€å®¹é”™ï¼Œæ”¯æŒå¤§æ–‡ä»¶å’Œå°æ–‡ä»¶ï¼Œå¼ºä¸€è‡´æ€§å¯¹å…ƒæ•°æ®è¦æ±‚é«˜ã€‚
2. æŠ€æœ¯é€‰å‹ trade-offï¼š
    * æ•°æ®åº“ï¼š é€‰å…³ç³»å‹ï¼ˆå¼ºä¸€è‡´ï¼Œæ‰©å±•éš¾ï¼‰è¿˜æ˜¯NoSQLï¼ˆæ˜“æ‰©å±•ï¼Œæœ€ç»ˆä¸€è‡´ï¼‰ï¼Ÿæˆ‘ä¼šç”¨NoSQLï¼ˆå¦‚DynamoDB/è‡ªç ”KVï¼‰åšå…ƒæ•°æ®å­˜å‚¨ï¼Œæ–‡ä»¶æ•°æ®åˆ™èµ°åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚S3ï¼‰ï¼Œå…ƒæ•°æ®å…³é”®æ“ä½œç”¨å¼ºä¸€è‡´æœºåˆ¶ä¿éšœã€‚
    * åŒæ­¥ vs å¼‚æ­¥å¤åˆ¶ï¼š åŒæ­¥æ›´å¯é ä½†å»¶è¿Ÿé«˜ï¼Œå¼‚æ­¥é«˜å¯ç”¨ä½†æœ‰çŸ­æš‚ä¸ä¸€è‡´ã€‚é‡‡ç”¨åŒºåŸŸå†…åŒæ­¥ï¼Œè·¨åŒºåŸŸå¼‚æ­¥ï¼Œå®ç°99.99%å¯ç”¨ã€‚
    * ç¼“å­˜ç­–ç•¥ï¼š çƒ­ç‚¹æ–‡ä»¶ä¸ŠRedis/æœ¬åœ°SSDï¼Œå†·æ•°æ®å®šæœŸä¸‹æ²‰åˆ°ä¾¿å®œå­˜å‚¨ï¼Œæƒè¡¡æˆæœ¬ä¸è®¿é—®é€Ÿåº¦ã€‚
    * åˆ†ç‰‡æ–¹æ¡ˆï¼š æŒ‰ç”¨æˆ·/æ–‡ä»¶ååšshardingï¼Œæ—¢ä¾¿äºæ‰©å±•ä¹Ÿæ˜“äºè·¯ç”±ï¼Œè€ƒè™‘hashç¢°æ’ç­‰é—®é¢˜ã€‚
    * å­˜å‚¨ä»‹è´¨ï¼š S3å†·ã€EBSçƒ­ï¼Œæƒè¡¡è¯»å†™å»¶è¿Ÿå’Œæˆæœ¬ã€‚
3. ç”Ÿå‘½å‘¨æœŸå…¨æµç¨‹ï¼š
    * å¼€å‘ï¼š å…ˆå®ç°å…ƒæ•°æ®APIå’Œæ–‡ä»¶åˆ†å—ä¸Šä¼ ä¸‹è½½ï¼ŒMockå¤§æ–‡ä»¶æµã€‚
    * æµ‹è¯•ï¼š å‹æµ‹å¹¶å‘ä¸Šä¼ ã€æ–­ç‚¹ç»­ä¼ ã€è·¨åŒºåŸŸåŒæ­¥ï¼Œæ³¨é‡ä¸€è‡´æ€§å’Œé«˜å¯ç”¨ã€‚
    * ä¸Šçº¿ï¼š ç°åº¦å‘å¸ƒã€è“ç»¿éƒ¨ç½²ï¼Œè‡ªåŠ¨å›æ»šã€‚
    * ç›‘æ§è¿ç»´ï¼š æ¥å…¥Prometheus/ELKï¼Œå…³æ³¨å»¶è¿Ÿã€IOPSã€é”™è¯¯ç ï¼Œå®æ—¶æŠ¥è­¦ã€‚
    * æ‰©å±•/å®¹ç¾ï¼š è‡ªåŠ¨æ‰©å®¹ï¼Œå¼‚åœ°å¤šæ´»ï¼Œè·¨åŒºæ•…éšœåˆ‡æ¢ã€‚
    * æˆæœ¬ä¼˜åŒ–ï¼š å®šæœŸå½’æ¡£å†·æ•°æ®ï¼Œè‡ªåŠ¨æ¸…ç†åƒåœ¾æ–‡ä»¶ã€‚
    * æŒç»­ä¼˜åŒ–ï¼š æ”¶é›†ç”¨æˆ·åé¦ˆï¼Œå®‰å…¨è¡¥ä¸ï¼Œåç»­åŠ ç‰ˆæœ¬æ§åˆ¶/åˆ†äº«/æƒé™ç³»ç»Ÿã€‚
    * åæœŸè¿­ä»£ï¼š é‡æ„å’Œè¿ç§»

æ¯ä¸€æ­¥éƒ½èƒ½è®²æ¸…æ¥šâ€œä¸ºä»€ä¹ˆè¿™ä¹ˆé€‰ï¼Œæœ‰ä»€ä¹ˆtrade-offï¼Œä»¥åŠå¦‚æœéœ€æ±‚å˜äº†æ€ä¹ˆè°ƒæ•´è®¾è®¡â€ã€‚

ç»´æŠ¤ - æ€§èƒ½ä¼˜åŒ–

ä»¥ä¸‹æ˜¯å¯¹æ¯ä¸ª ç³»ç»Ÿ RT æŠ€æœ¯ç»“èŠ‚ çš„è¯¦ç»†å±•å¼€ï¼ŒåŒ…æ‹¬å‘ç”Ÿæœºåˆ¶ã€å…¸å‹è¡¨ç°ã€æ’æŸ¥æ‰‹æ®µã€ä¼˜åŒ–æ–¹æ¡ˆä»¥åŠæ¨èå·¥å…·ã€‚

ğŸŸ¥ 1. ä¸Šæ¸¸ç“¶é¢ˆ - ç½‘å…³å±‚æµé‡æ§åˆ¶ä¸è¶³
é¡¹ç›®	å†…å®¹
æœºåˆ¶	ç½‘å…³ï¼ˆå¦‚ Nginxã€Kongã€Envoyï¼‰é»˜è®¤æœªåšé™æµï¼Œé«˜å¹¶å‘è¯·æ±‚æœªè¢«æ‹¦æˆªï¼Œå…¨é‡æ‰“åˆ°åç«¯ï¼Œå¯¼è‡´æœåŠ¡ä¸å¯ç”¨æˆ– RT é£™å‡ã€‚
è¡¨ç°	ç½‘å…³å±‚ CPU é£™å‡ï¼›åç«¯ç¬é—´å´©æºƒï¼›æ²¡æœ‰ç¼“å†²ä¿æŠ¤ã€‚
æ’æŸ¥æ–¹å¼	è§‚å¯Ÿ ingress ç½‘å…³ QPSã€502/503 æ¯”ä¾‹ï¼›Grafana çœ‹ upstream overflow æŒ‡æ ‡ã€‚
ä¼˜åŒ–æ–¹æ¡ˆ	è®¾ç½® IP/QPS é™æµè§„åˆ™ï¼ˆå¦‚ Redis æ»‘åŠ¨çª—å£é™æµã€token bucketï¼‰ï¼›æ¥å…¥ API Gateway é™é€Ÿæ’ä»¶ï¼›å¯ç”¨ circuit breakerã€‚
æ¨èå·¥å…·	Envoyã€Kongã€Istioã€Spring Cloud Gateway
ğŸŸ§ 2. ä¸­é—´å±‚é˜»å¡ - ä¸­é—´æœåŠ¡ä¾èµ–é‡ï¼Œæ¥å£ä¸²è”
é¡¹ç›®	å†…å®¹
æœºåˆ¶	å¤šå±‚å¾®æœåŠ¡ä¸²è”ï¼Œä»»ä½•ä¸€å±‚æ…¢å°±ä¼šæ‹–æ…¢å…¨é“¾è·¯ï¼›å¦‚ A â†’ B â†’ Cï¼ŒC æ…¢ï¼ŒA ä¹Ÿæ…¢ã€‚
è¡¨ç°	å•æ¡é“¾è·¯ RT æ˜æ˜¾å˜é•¿ï¼›P99 RT æŒ‡æ ‡é£™å‡ï¼›æŸæœåŠ¡å“åº”å˜æ…¢ä½†æ— æ˜æ˜¾å¼‚å¸¸ã€‚
æ’æŸ¥æ–¹å¼	ç”¨ tracing å·¥å…·ï¼ˆå¦‚ Jaegerï¼‰å®šä½å“ªæ®µé“¾è·¯è€—æ—¶ï¼›åˆ†æ P95/P99 å»¶è¿Ÿç‚¹ï¼›è§‚å¯Ÿè¶…æ—¶/è°ƒç”¨å †å å›¾ã€‚
ä¼˜åŒ–æ–¹æ¡ˆ	æ”¹ä¸²è¡Œä¸ºå¹¶è¡Œï¼ˆå¦‚ fan-outï¼‰ï¼›æ‹†æœåŠ¡/åˆæœåŠ¡ï¼›ä½¿ç”¨ async queueï¼›æ·»åŠ  fallbackã€‚
æ¨èå·¥å…·	OpenTelemetry, Jaeger, Zipkin, SkyWalking
ğŸŸ¥ 3. ä¸‹æ¸¸ä¾èµ–æŒ‚äº† - Redis / MySQL / Kafka å˜æ…¢
é¡¹ç›®	å†…å®¹
æœºåˆ¶	é¢‘ç¹ DB å†™å…¥ï¼›Redis key æ“ä½œè¶…æ—¶ï¼›Kafka backlog ç´¯ç§¯ï¼›ä¾èµ– IO æ…¢ï¼Œå¯¼è‡´ä¸Šæ¸¸çº¿ç¨‹é˜»å¡ã€‚
è¡¨ç°	Thread pool saturationï¼›RT é£™å‡ï¼›è¿æ¥æ± æ‰“æ»¡ï¼›å¤§é‡çº¿ç¨‹å¤„äº BLOCKED çŠ¶æ€ã€‚
æ’æŸ¥æ–¹å¼	jstack çœ‹çº¿ç¨‹çŠ¶æ€ï¼›ç›‘æ§è¿æ¥æ± æŒ‡æ ‡ï¼ˆHikariCPã€Redis connï¼‰ï¼›ä¾èµ–æœåŠ¡çš„æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚
ä¼˜åŒ–æ–¹æ¡ˆ	æå‰åšæ•°æ®é¢„å†™å…¥ï¼›åŠ ç¼“å­˜ï¼›ä½¿ç”¨å¼‚æ­¥å¤„ç†ï¼›å¢åŠ çº¿ç¨‹æ± éš”ç¦»å±‚ã€‚
æ¨èå·¥å…·	RedisInsight, Kafka UI, MySQL slow log, Arthas/jstack
ğŸŸ¨ 4. ç¼ºä¹é™çº§æœºåˆ¶ - æ—  timeout/é‡è¯•/éš”ç¦»ç­–ç•¥
é¡¹ç›®	å†…å®¹
æœºåˆ¶	è¯·æ±‚å¤±è´¥æ—¶ä»ç»§ç»­ç­‰å¾…æˆ–é‡è¯•ï¼Œå¯¼è‡´èµ„æºå †ç§¯ï¼›æ²¡æœ‰ fallback é™çº§æ‰‹æ®µï¼›å¤±è´¥ä¼ æ’­åˆ°å…¨é“¾è·¯ã€‚
è¡¨ç°	æŸæ¥å£ RT ä» 100ms â†’ 10sï¼›å…¨é“¾æœåŠ¡å“åº”å˜æ…¢ç”šè‡³ä¸å¯ç”¨ã€‚
æ’æŸ¥æ–¹å¼	æ£€æŸ¥æœåŠ¡æ˜¯å¦é…ç½® timeoutï¼ˆå¦‚ feign/hystrix è®¾ç½®ï¼‰ï¼›è§‚å¯Ÿ retry æ¬¡æ•°å’Œå¤±è´¥ç‡ã€‚
ä¼˜åŒ–æ–¹æ¡ˆ	è®¾ç½®åˆç† timeoutï¼ˆ200ms ~ 1sï¼‰ï¼›ä½¿ç”¨ bulkhead pattern + fallbackï¼›é™çº§ç­–ç•¥ï¼ˆé™ç²¾åº¦/è¿”å›é»˜è®¤å€¼ï¼‰ã€‚
æ¨èå·¥å…·	Resilience4j, Sentinel, Hystrixï¼ˆå·²åœç»´æŠ¤ï¼‰
ğŸŸ§ 5. GC é—®é¢˜ - Full GCé¢‘å‘/å†…å­˜æŠ–åŠ¨
é¡¹ç›®	å†…å®¹
æœºåˆ¶	å†…å­˜ä½¿ç”¨ä¸å½“ï¼Œé¢‘ç¹è§¦å‘ Full GCï¼›è€å¹´ä»£é¢‘ç¹æ»¡ï¼›å¤§å¯¹è±¡é¢‘ç¹åˆ›å»ºã€‚
è¡¨ç°	jstat æ˜¾ç¤º FGCT å¢é«˜ï¼›å †å†…å­˜æ³¢åŠ¨å¤§ï¼›åº”ç”¨å¡é¡¿ã€‚
æ’æŸ¥æ–¹å¼	GC æ—¥å¿—ï¼›jmap â€“histo åˆ†æå¯¹è±¡ï¼›Arthas/VisualVM åˆ†æ heap dumpã€‚
ä¼˜åŒ–æ–¹æ¡ˆ	JVM è°ƒä¼˜ï¼ˆ-XX:+UseG1GCï¼‰ï¼›åŠ å¤§å †/åŒºåˆ†å†·çƒ­æ•°æ®ï¼›å¯¹è±¡å¤ç”¨/æ± åŒ–ï¼›æ”¹ç”¨è½»é‡å¯¹è±¡ç»“æ„ã€‚
æ¨èå·¥å…·	JProfiler, GCeasy.io, VisualVM, JFR (Java Flight Recorder)
ğŸŸ¨ 6. æ¶ˆæ¯ç§¯å‹ - MQ æ¶ˆè´¹ä¸åŠæ—¶
é¡¹ç›®	å†…å®¹
æœºåˆ¶	Kafka ç­‰ MQ çš„ç”Ÿäº§/æ¶ˆè´¹é€Ÿç‡ä¸åŒ¹é…ï¼Œå¯¼è‡´ backlogã€‚
è¡¨ç°	æ¶ˆæ¯å»¶è¿Ÿï¼ˆlagï¼‰å¢åŠ ï¼›æ–°è¯·æ±‚æ’ä¸ä¸Šï¼›ç«¯åˆ°ç«¯ RT å¢é«˜ã€‚
æ’æŸ¥æ–¹å¼	Kafka Consumer Group Lagï¼›æ¶ˆæ¯è¿›å‡º TPSï¼›broker CPU ä½¿ç”¨ã€‚
ä¼˜åŒ–æ–¹æ¡ˆ	å¢åŠ æ¶ˆè´¹è€…æ•°é‡ï¼›ä½¿ç”¨æ‰¹å¤„ç†æ¶ˆè´¹ï¼›æé«˜å¹¶è¡Œåº¦ï¼›æ¶ˆè´¹ç«¯é™é€Ÿå¤„ç†ã€‚
æ¨èå·¥å…·	Kafka UIã€Confluent Control Centerã€Burrowã€Prometheus exporter
ğŸŸ¥ 7. ç¼“å­˜å¤±æ•ˆ/çƒ­ç‚¹ç©¿é€
é¡¹ç›®	å†…å®¹
æœºåˆ¶	ç¼“å­˜ key æœªå‘½ä¸­æˆ–è¢«æ‰“ç©¿ï¼ˆå¹¶å‘å‡»ä¸­åŒä¸€ keyï¼Œç¼“å­˜æœªè¿”å›ï¼‰ï¼›é¢‘ç¹è®¿é—®è½åˆ°åº•å±‚æ•°æ®åº“ã€‚
è¡¨ç°	ç¼“å­˜å‘½ä¸­ç‡ä¸‹é™ï¼›DB TPS é£™å‡ï¼›RT æ€¥å‰§ä¸Šå‡ã€‚
æ’æŸ¥æ–¹å¼	ç¼“å­˜ hit/miss ç›‘æ§ï¼›çƒ­ç‚¹ key tracingï¼›ç¼“å­˜ä¸ DB TPS å¯¹æ¯”å›¾ã€‚
ä¼˜åŒ–æ–¹æ¡ˆ	æœ¬åœ°ç¼“å­˜ + å¤šçº§ç¼“å­˜ï¼›ç¼“å­˜é¢„çƒ­ï¼›å¸ƒéš†è¿‡æ»¤å™¨é˜²ç©¿é€ï¼›äº’æ–¥é”é˜²å‡»ç©¿ã€‚
æ¨èå·¥å…·	Redis + local cacheï¼ˆCaffeine/Guavaï¼‰ï¼›ç›‘æ§å¹³å°è‡ªå®šä¹‰æŒ‡æ ‡
'''
'''
1. Basic Component (MessageQueue; DataBase; Cache; Lock; RateLimiter; CDN; API gateway; SSO; CI/CD; SLA/SLO; Log; Monitoring; ...)
2. Whole System (Facebook; Amazon; Google Search/Docs/Drive/Youtube; Quant; ... )

### âœ… 1. æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ç³»ç»Ÿè®¾è®¡å›¾ï¼šProducer â†’ Queue â†’ Consumer æ¶æ„

# æ¦‚å¿µå›¾ï¼ˆå¯è§†åŒ–æ€ç»´å¯¼å›¾ï¼Œé¢è¯•å¯å¿«é€Ÿç”»å‡ºï¼‰
# [Producer] --> [Broker: Queue/Topic] --> [Consumer]
#                â†‘ Storage + Retry + DLQ + Ordering
#                â†“ Scale out: Partitioned + Distributed

# æ¶æ„æ ¸å¿ƒç»„ä»¶ï¼š
- **Producer**ï¼šå‘é€æ¶ˆæ¯åˆ° Brokerï¼Œå¯å¸¦é‡è¯•æœºåˆ¶ï¼ŒACK æ§åˆ¶
- **Broker**ï¼ˆMQä¸­é—´ä»¶ï¼‰ï¼šå­˜å‚¨ã€è½¬å‘æ¶ˆæ¯çš„æ ¸å¿ƒç»„ä»¶ï¼ˆå¦‚ Kafkaã€RabbitMQï¼‰
  - æ”¯æŒ **Partitionï¼ˆåˆ†åŒºï¼‰** å®ç°æ°´å¹³æ‰©å±•ï¼ˆscale-outï¼‰
  - æ”¯æŒ **Message ordering**ï¼ˆå•åˆ†åŒºä¿è¯é¡ºåºï¼‰
  - æ”¯æŒ **Durability / Replication**
  - æ”¯æŒ **Retry / Dead Letter Queue (DLQ)**
  - æ”¯æŒ **At least once / Exactly once** delivery è¯­ä¹‰
- **Consumer**ï¼šæ¶ˆè´¹æ¶ˆæ¯ï¼ˆPull/Push æ¨¡å¼ï¼‰ï¼Œæ”¯æŒå¹¶å‘å¤„ç†
  - æ”¯æŒ **Offset tracking / Commit**
  - å¯ä½¿ç”¨ **consumer group** æå‡å¹¶å‘åº¦

---

### âœ… 2. ä¸‰é¢˜ System Design è§£ç­”

#### ğŸ§± Design a Message Queue
- å¯å‚è€ƒä¸Šé¢å›¾ï¼ˆKafka æ¨¡å‹ï¼‰
- å…³é”®ç‚¹ï¼šåˆ†å¸ƒå¼ã€é«˜å¯ç”¨ã€é¡ºåºã€é‡è¯•ã€å¹‚ç­‰æ€§ã€å­˜å‚¨å‹ç¼©ï¼ˆlog compactionï¼‰
- å»¶ä¼¸ç‚¹ï¼šå¦‚ä½•åšæµæ§ï¼ˆrate limitï¼‰ã€å¦‚ä½•åšå»¶è¿Ÿæ¶ˆæ¯ï¼ˆdelay queueï¼‰

#### ğŸ¢ Design URL Shortenerï¼ˆbit.lyï¼‰
- è¾“å…¥é•¿é“¾æ¥ï¼Œè¿”å›çŸ­é“¾
- Core:
  - Hashingï¼ˆMD5/Base62ï¼‰
  - DB mapping: shortKey -> longURL
  - Cache å±‚ï¼ˆRedisï¼‰åŠ é€Ÿçƒ­é“¾æ¥
  - API: Create, Expand, Metrics
  - é«˜å¯ç”¨å­˜å‚¨ï¼ˆNoSQL + Cacheï¼‰
  - æ•°æ®å½’æ¡£/æ¸…ç†æœºåˆ¶ï¼ˆTTLï¼‰

#### ğŸ‘¥ Design Rate Limiterï¼ˆé™æµå™¨ï¼‰
- ç»å…¸è§£æ³•ï¼š
  - Token Bucketï¼ˆæ¼æ¡¶ï¼‰
  - Sliding Window Counter
- æŠ€æœ¯å®ç°ï¼š
  - Redis + Lua åŸå­æ“ä½œå®ç°è®¡æ•°å™¨
  - nginx ingress é™æµ
  - Kafka æ¶ˆè´¹é€Ÿç‡æ§åˆ¶
- å»¶ä¼¸é—®é¢˜ï¼š
  - å¦‚ä½• per-user/per-IP é™æµï¼Ÿ
  - é™æµå¼‚å¸¸å¦‚ä½•å‘Šè­¦ï¼Ÿ
'''
